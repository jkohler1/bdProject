Visualiser les pays qui pour une même date on eu plus de 5000 cas d'hospitalisations

select h1.date, p.nom
from Pays p, Hospitalisations h1, Hospitalisations h2
where p.iso_code=h1.iso_code and h1.iso_code <> h2.iso_code and h1.hosp_patients>5000 and h2.hosp_patients>5000 and h1.date=h2.date
group by h1.date, p.nom

Sélectionnez le pays qui a administré le plus grand nombre total de vaccins

select T.iso_code , sum(T.vaccinations) as numberVaccination, P.nom
from Tests T
left join Pays P on P.iso_code = T.iso_code
group by T.iso_code
order by numberVaccination desc

Pour chaque vaccin, sélectionnez le nom des pays qui l’utilisent

select V.vaccins, GROUP_CONCAT(P.nom) as "Liste vaccins"
from Vaccins V
join Vaccins_Pays VP on V.id_vaccin = VP.id_vaccin
join Pays P on P.iso_code = VP.iso_code
group by V.id_vaccin

La proportion de la population hospitalisée pour chaque pays, le 1er janvier 2021

select H.hosp_patients, P.nom, P.population, (H.hosp_patients/P.population)*100 as ProportionHospit
from Hospitalisations H join Pays P on P.iso_code = H.iso_code
where H.date="2021-01-01"

Calculez l’évolution, pour chaque jour et chaque pays, du nombre de patients hospitalisés

SELECT P1.nom,P1.iso_code, (H2.hosp_patients-H1.hosp_patients) as 'nombre hospit', H2.date
FROM Pays P1, Hospitalisations H1, Hospitalisations H2
WHERE H1.iso_code=H2.iso_code AND DATE_ADD(H1.date, INTERVAL 1 DAY) = H2.date AND H2.iso_code=P1.iso_code
ORDER BY P1.nom, H2.date

Sélectionnez le nom des vaccins disponibles à la fois en Belgique et en France

select V.vaccins
from Vaccins V, Vaccins_Pays VP1, Vaccins_Pays VP2
where VP1.iso_code='BEL' AND VP2.iso_code='FRA' AND VP2.id_vaccin=VP1.id_vaccin AND V.id_vaccin=VP1.id_vaccin

EOF
